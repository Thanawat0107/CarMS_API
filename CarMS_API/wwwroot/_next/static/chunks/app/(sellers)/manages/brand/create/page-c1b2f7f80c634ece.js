(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[344,488],{559:(e,a,s)=>{"use strict";s.d(a,{D:()=>r,p:()=>l});let l="https://localhost:7001",r=l+"/api/"},1809:(e,a,s)=>{"use strict";s.d(a,{Ay:()=>h,HD:()=>c,L:()=>d,Mu:()=>u,bQ:()=>m,g7:()=>i});var l=s(404),r=s(4317),t=s(559);let n=(0,l.xP)({reducerPath:"brandApi",baseQuery:(0,r.cw)({baseUrl:t.D}),tagTypes:["Brand"],endpoints:e=>({getBrandAll:e.query({query:e=>({url:"brands/getall",method:"GET",params:e}),keepUnusedDataFor:300,transformResponse:async e=>{var a;return{result:null!=(a=e.result)?a:[],meta:e.meta}},providesTags:["Brand"]}),getBrandById:e.query({query:e=>({url:"brands/getbyid/".concat(e),method:"GET"}),keepUnusedDataFor:300,transformResponse:async e=>{if(e.result)return e.result;throw Error(e.message)},providesTags:(e,a,s)=>[{type:"Brand",brandId:s}]}),createBrand:e.mutation({query:e=>({url:"brands/create",method:"POST",body:e}),transformResponse:e=>{if(e.result)return e.result;throw Error(e.message)},invalidatesTags:["Brand"]}),updateBrand:e.mutation({query:e=>{let{formData:a,brandId:s}=e;return{url:"brands/update/".concat(s),method:"PUT",body:a}},transformResponse:e=>{if(e.result)return e.result;throw Error(e.message)},invalidatesTags:["Brand"]}),deleteBrand:e.mutation({query:e=>({url:"brands/delete/".concat(e),method:"PUT"}),transformResponse:e=>{if(e.result)return e.result;throw Error(e.message)},invalidatesTags:["Brand"]})})}),{useGetBrandAllQuery:i,useGetBrandByIdQuery:d,useCreateBrandMutation:u,useUpdateBrandMutation:c,useDeleteBrandMutation:m,usePrefetch:o}=n,h=n},2073:(e,a,s)=>{"use strict";s.d(a,{default:()=>g});var l=s(5155),r=s(2115),t=s(9694),n=s(5695),i=s(4752),d=s.n(i),u=s(4149),c=s.n(u),m=s(1809),o=s(7129);let h=o.Ik().shape({name:o.Yj().required("กรุณากรอกชื่อแบรนด์"),imageFile:o.gl().nullable(),isUsed:o.zM()}),p=o.Ik().shape({name:o.Yj().required("กรุณากรอกชื่อแบรนด์"),imageFile:o.gl().nullable(),isUsed:o.zM(),isDelete:o.zM()});var b=s(559);let x=c()(d());function g(){let e=(0,n.useRouter)(),a=(0,n.useParams)(),s=null==a?void 0:a.id,i=!!s,{data:d,isLoading:u}=(0,m.L)(Number(s),{skip:!i}),[c]=(0,m.Mu)(),[o]=(0,m.HD)(),[g,f]=(0,r.useState)(null),[v,j]=(0,r.useState)(i?{name:"",imageFile:null,isUsed:!1,isDelete:!1}:{name:"",imageFile:null,isUsed:!1});(0,r.useEffect)(()=>{if(i&&d){var e;j({name:null!=(e=d.name)?e:"",imageFile:null,isUsed:d.isUsed,isDelete:d.isDelete})}},[i,d]),(0,r.useEffect)(()=>{i&&(null==d?void 0:d.imageUrl)&&f(b.p+d.imageUrl)},[i,null==d?void 0:d.imageUrl]);let y=async a=>{let l=new FormData;l.append("name",a.name),l.append("isUsed",String(a.isUsed)),a.imageFile&&l.append("imageFile",a.imageFile),i?(l.append("isUsed",String(a.isUsed)),l.append("isDelete",String(a.isDelete)),await o({brandId:Number(s),formData:l}).unwrap(),await N("อัปเดตแบรนด์สำเร็จ")):(await c(l).unwrap(),await N("เพิ่มแบรนด์สำเร็จ")),e.push("/manages/brand")},N=e=>x.fire({icon:"success",title:"สำเร็จ",text:e,timer:1500,showConfirmButton:!1}),w=(0,t.Wx)({enableReinitialize:!0,initialValues:v,validationSchema:i?p:h,onSubmit:y});return i&&u?(0,l.jsx)("p",{children:"กำลังโหลดข้อมูล..."}):(0,l.jsx)("div",{className:"min-h-screen bg-base-200 py-10 px-4",children:(0,l.jsx)("div",{className:"max-w-5xl mx-auto bg-base-100 shadow-xl rounded-2xl overflow-hidden",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2",children:[(0,l.jsx)("div",{className:"bg-base-300 p-6 flex items-center justify-center",children:g?(0,l.jsx)("img",{src:g,alt:"Preview",className:"rounded-xl shadow w-full h-80 object-contain bg-white p-2"}):(0,l.jsx)("div",{className:"w-full h-80 flex items-center justify-center border border-dashed border-gray-400 rounded-xl",children:(0,l.jsx)("span",{className:"text-gray-500",children:"ไม่มีภาพ"})})}),(0,l.jsxs)("div",{className:"p-8",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold text-center mb-6",children:i?"แก้ไขแบรนด์":"เพิ่มแบรนด์"}),(0,l.jsxs)("form",{onSubmit:w.handleSubmit,className:"space-y-5",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-semibold mb-1",children:"ชื่อแบรนด์"}),(0,l.jsx)("input",{type:"text",name:"name",value:w.values.name,onChange:w.handleChange,className:"input input-bordered w-full",placeholder:"กรอกชื่อแบรนด์"}),w.touched.name&&w.errors.name&&(0,l.jsx)("p",{className:"text-red-500 text-sm mt-1",children:w.errors.name})]}),(0,l.jsx)("div",{className:"form-control",children:(0,l.jsxs)("label",{className:"label cursor-pointer",children:[(0,l.jsx)("span",{className:"label-text",children:"ใช้งานแบรนด์นี้"}),(0,l.jsx)("input",{type:"checkbox",name:"isUsed",checked:w.values.isUsed,onChange:w.handleChange,className:"checkbox checkbox-primary ml-2"})]})}),i&&(0,l.jsx)("div",{className:"form-control",children:(0,l.jsxs)("label",{className:"label cursor-pointer",children:[(0,l.jsx)("span",{className:"label-text text-red-500",children:"ลบแบรนด์นี้"}),(0,l.jsx)("input",{type:"checkbox",name:"isDelete",checked:w.values.isDelete,onChange:w.handleChange,className:"checkbox checkbox-error ml-2"})]})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-semibold mb-1",children:"รูปภาพ (ถ้ามี)"}),(0,l.jsx)("input",{type:"file",name:"image",accept:"image/*",className:"file-input file-input-bordered w-full",onChange:e=>{var a;let s=(null==(a=e.currentTarget.files)?void 0:a[0])||null;if(w.setFieldValue("imageFile",s),s){let e=new FileReader;e.onloadend=()=>f(e.result),e.readAsDataURL(s)}else f(null)}})]}),(0,l.jsx)("button",{type:"submit",className:"btn btn-primary w-full",disabled:w.isSubmitting,children:i?"อัปเดต":"บันทึก"})]})]})]})})})}},8280:(e,a,s)=>{Promise.resolve().then(s.bind(s,2073))}},e=>{var a=a=>e(e.s=a);e.O(0,[320,404,34,441,684,358],()=>a(8280)),_N_E=e.O()}]);